# pgAdmin4 Configuration
# Documentation: https://github.com/runix/helm-charts/tree/master/charts/pgadmin4

env:
  email: "admin@example.com"
  password: "admin"

# Resource limits (similar to "small" preset logic)
resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 200m
    memory: 512Mi

# Persistence for pgAdmin configuration
persistentVolume:
  enabled: true
  size: 1Gi

extraVolumes:
  - name: definitions
    configMap:
      name: pgadmin-servers

extraInitContainers: |
  - name: import-servers-json
    image: "docker.io/dpage/pgadmin4:latest"
    imagePullPolicy: Always
    command:
      - /bin/sh
      - -c
      - |
        /venv/bin/python /pgadmin4/setup.py load-servers --user admin@example.com --auth-source internal --replace /pgadmin4/servers.json
    volumeMounts:
      - name: pgadmin-data
        mountPath: /var/lib/pgadmin
      - name: definitions
        mountPath: /pgadmin4/servers.json
        subPath: servers.json
    securityContext:
      runAsUser: 0
